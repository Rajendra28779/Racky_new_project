<div class="form-cointainer">
    <div class="main-tab">
        <div class="row justify-content-between">
            <div class="col-lg-4">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a routerLink="/hospitalwisefloatnumberDetails" routerLinkActive="active" class="nav-link" style="color: #1f723f;">
                            Hospital Wise Float List For Post Payment (Updation)</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-4 col-xxl-4">
            Float Number : <strong>{{float}}</strong>
        </div>
        <div class="col-lg-4 col-xxl-4">
            Generated By : <strong>{{createdByName}}</strong>
        </div>
        <div class="col-lg-4 col-xxl-4">
            SNA Doctor : <strong>{{snoName}}</strong>
        </div>
    </div>
    <div class="row" style="margin-top: 10px;margin-bottom: 10px;">
        <div class="col-lg-4 col-xxl-4" style="padding-top: 10px; padding-left: 17px;">
            <b>Total No of Hospital: <span style="color: green;">{{hospitalwisefloatdetails?.length}}</span></b>
        </div>
        <div class="col-lg-4 col-xxl-4" style="text-align: right; padding-top: 3px;">
            <!-- <button class="btn btn-outline-success btn-sm me-1" tooltip="Excel" (click)="downloadReport('excel')">
                <i class="bi bi-file-earmark-spreadsheet" style="font-size: 11pt;"></i>
            </button> &nbsp; -->
            <button class="btn btn-outline-danger btn-sm me-1" tooltip="pdf" (click)="downloadReportforpdf('pdf')">
                <i class="bi bi-file-earmark-pdf" style="font-size: 11pt;"></i>
            </button>
        </div>
        <div class="col-lg-4 col-xxl-4">
            <div class="input-group">
                <input type="text " id="txtsearchDate" name="txtsearchDate " [(ngModel)]="txtsearchDate" maxlength="20 " class="form-control " placeholder="Search here...... " autocomplete="off">
            </div>
        </div>
    </div>
    <div class="content-box p-0 overflow-hidden">
        <div class="table-responsive">
            <table class="table mb-0">
                <thead>
                    <tr>
                        <th>Sl No</th>
                        <th>State Name</th>
                        <th>District Name</th>
                        <th>Hospital Code</th>
                        <th>Hospital Name</th>
                        <th style="text-align: center;">Claims Submitted</th>
                        <th>Claim Amount (&#8377;)</th>
                        <th style="text-align: center;">Approved Claims</th>
                        <th>SNA Approved Amount (&#8377;)</th>
                        <th>Freezed Round of Amount (&#8377;)</th>
                        <th>Bank Name</th>
                        <th>Account Number</th>
                        <th>IFSC Code</th>
                        <th style="text-align: center;">Details</th>
                        <th style="text-align: center;">Post-Payment</th>
                        <th style="text-align: center;">Post-Payment View</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of hospitalwisefloatdetails | filter:txtsearchDate | paginate: {id: 'listing_pagination', itemsPerPage: pageElement, currentPage: currentPage}; index as i" (mouseenter)="hoveredRow = i" (mouseleave)="hoveredRow = null" [ngClass]="{'hovered': hoveredRow === i,'highlighted': item.floatstatus ==='1'}">
                        <td *ngIf="currentPage==1">{{i+1}}</td>
                        <td *ngIf="currentPage!=1">{{(currentPage-1)*pageElement+i+1}}</td>
                        <td>{{item.stateName}}</td>
                        <td>{{item.districtName}}</td>
                        <td>{{item.hospitalCode}}</td>
                        <td>{{item.hospitalName}}</td>
                        <td style="text-align: center;">{{item.claimraised}}</td>
                        <td>{{item.claimamount | indianCurrency}}</td>
                        <td style="text-align: center;">{{item.approved}}</td>
                        <td>{{item.snoamount |indianCurrency}}</td>
                        <td>{{item.roundofamount |indianCurrency}}</td>
                        <td>{{item.bankname}}</td>
                        <td>{{item.accountnumber}}</td>
                        <td>{{item.ifsccode}}</td>
                        <td style="text-align: center;">
                            <a class="btn btn-outline-success btn-sm" (click)="view(item)">Detail</a>
                        </td>
                        <td style="text-align: center;">
                            <a class="btn btn-outline-success btn-sm" id="button" data-bs-toggle="modal" data-bs-target="#postpaymentModal" (click)="initializePayment(item.roundofamount,item.hospitalCode,item.snoamount,item.approved,item.hospitalName,item.bankname,item.ifsccode,item.accountnumber)">Pay</a>
                        </td>
                        <td style="text-align: center">
                            <a *ngIf="item.floatstatus === '1'" style="text-align: center;" data-bs-toggle="modal" data-bs-target="#modalData" (click)="viewData(item.hospitalCode, item.hospitalName, item.roundofamount)">
                                <i class="bi bi-eye icon" style="font-size: 21px;"></i>
                            </a>
                        </td>
                    </tr>
                    <tr *ngIf="hospitalwisefloatdetails?.length">
                        <td>Total </td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align: center;" style="font-weight: bold; color: rgb(12, 12, 12);">{{totalClaimRaised}}</td>
                        <td style="font-weight: bold; color: rgb(12, 12, 12);">{{totalClaimAmount | indianCurrency}}</td>
                        <td style="text-align: center;" style="font-weight: bold; color: rgb(12, 12, 12);">{{totalApproved}}</td>
                        <td style="font-weight: bold; color: rgb(12, 12, 12);">{{totalSnoAmount | indianCurrency}}</td>
                        <td style="font-weight: bold; color: rgb(12, 12, 12);">{{roundofamount | indianCurrency}}</td>
                        <td style="text-align: center;"> </td>
                    </tr>
                    <tr *ngIf="!hospitalwisefloatdetails?.length">
                        <td colspan="10" align="center"><strong class="text-danger">No data found</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row" style="margin-top: 20px" *ngIf="showPegi">
        <div class="col-sm-4">
            <div class="col-sm-*">
                show
                <select id="pageItem" name="pageItem" class="custom-select-sm" (change)="pageItemChange()">
                    <option value="100">100</option>
                    <option value="200">200</option>
                    <option value="300">300</option>
                    <option value="400">400</option>
                    <option value="">All</option>
                </select> entries
            </div>
        </div>
        <div class="col-sm-8 text-right">
            <pagination-controls id="listing_pagination" [maxSize]="100" [directionLinks]="true" (pageChange)="currentPage = $event" class="text-end" (pageBoundsCorrection)="onPageBoundsCorrection($event)"></pagination-controls>
        </div>
    </div>
</div>
<br>

<!-- Modal Hospitalwisefloatdetails -->
<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-focus="false">
    <div class="modal-dialog" style="max-width: 95%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Hospital Wise Float Details</h5>
                <button type="button" #closebutton class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="height: 575pt;">
                <div class="row" style="margin-top: 10px;margin-bottom: 10px;" *ngIf="modaldala?.length">
                    <div class="col-lg-4 col-xxl-4" style="padding-top: 10px; padding-left: 12px;">
                        <div class="form-group">
                            <b>Total Cases: <span style="color: green;">{{modaldala?.length}}</span></b>
                        </div>
                    </div>
                    <div class="col-lg-4 col-xxl-4" style="text-align: right; padding-top: 3px;">
                        <div class="form-group">
                            <button class="btn btn-outline-danger btn-sm me-1" type="submit" (click)="downloadReports('pdf')">
                                <i class="bi bi-file-earmark-pdf" style="font-size: 13pt;"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-4 col-xxl-4">
                        <div class="input-group">
                            <input type="text" id="txtSearch" class="form-control" placeholder="Search here" name="txtSearch" [(ngModel)]="txtSearch">
                        </div>
                    </div>
                </div>
                <div class="form-cointainer" *ngIf="modaldala?.length">
                    <div class="main-tab">
                        <div class="row justify-content-between">
                            <div class="table-responsive" style="height: 505pt;">
                                <table class="table table-striped" mb-0>
                                    <thead>
                                        <tr>
                                            <th>Sl No</th>
                                            <th>Hospital Details</th>
                                            <th>District</th>
                                            <th>URN</th>
                                            <th>Invoice No</th>
                                            <th>Claim No</th>
                                            <th>Patient Name</th>
                                            <th>Gender</th>
                                            <th>Package Code</th>
                                            <th>Package Cost (&#8377;)</th>
                                            <th>Package Procedure</th>
                                            <th>Actual Date Of Admission</th>
                                            <th>Actual Date Of Discharge</th>
                                            <th>Mortality (Hospital)</th>
                                            <th>Mortality (CPD)</th>
                                            <th>Hospital Claimed Amount (&#8377;)</th>
                                            <th>Implant Data</th>
                                            <th>CPD Claim Status</th>
                                            <th>CPD Remarks</th>
                                            <th>CPD Approved Amount (&#8377;)</th>
                                            <th>SNA Claim Status</th>
                                            <th>SNA Remarks</th>
                                            <th>SNA Approved Amount(SNA/CPD) (&#8377;)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of modaldala | filter:txtSearch;index as i">
                                            <td>{{i+1}}</td>
                                            <td>{{item[1]}} ({{item[2]}})</td>
                                            <td>{{item[3]}}</td>
                                            <td>{{item[4]}}</td>
                                            <td>{{item[5]}}</td>
                                            <td>{{item[6]}}</td>
                                            <td>{{item[7]}}</td>
                                            <td>{{item[8]}}</td>
                                            <td title="{{item[10]}}"><span class="pkd">{{item[9]}}</span></td>
                                            <td>{{item[11]}}</td>
                                            <td>{{item[12]}}</td>
                                            <td>{{item[13]}}</td>
                                            <td>{{item[14]}}</td>
                                            <td>{{item[15]}}</td>
                                            <td>{{item[16]}}</td>
                                            <td>{{item[17]}}</td>
                                            <td>{{item[18]}}</td>
                                            <td>{{item[19]}}</td>
                                            <td>
                                                <span *ngIf="item[20] != '-NA-'"><a href="javascript:void(0)" (click)="show(item[20])">view</a></span>
                                                <span *ngIf="item[20] == '-NA-'">-NA-</span>
                                            </td>
                                            <td>{{item[21]}}</td>
                                            <td>{{item[22]}}</td>
                                            <td>
                                                <span *ngIf="item[23] != '-NA-'"><a href="javascript:void(0)" (click)="show(item[23])">view</a></span>
                                                <span *ngIf="item[23] == '-NA-'">-NA-</span>
                                            </td>
                                            <td>{{item[24]}}</td>
                                        </tr>
                                        <tr *ngIf="! modaldala?.length">
                                            <td colspan="18" align="center"><strong class="text-danger">No data found</strong></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<!-- Modal -->
<div class="modal fade" id="postpaymentModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-focus="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">
                    <span>Payment Details</span>
                </h5>
                <button type="button" #closebutton class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="cancel()"></button>
            </div>
            <div class="modal-body">
                <!-- First Card -->
                <div class="card custom-bg-secondary bg-gradient mb-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Freezed Round of Amount<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(255, 4, 4);">
                                <b><span>{{ totalPaidAmount | indianCurrency }}</span></b>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Hospital Name<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(20, 20, 20);">
                                <b><span>{{ hospitalnamedata }}</span></b>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Hospital Code<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(20, 20, 20);">
                                <b><span>{{ hospitalCodedata }}</span></b>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Bank Name<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(20, 20, 20);">
                                <b><span>{{ banknamedata }}</span></b>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Account Number<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(20, 20, 20);">
                                <b><span>{{ accountnamedata }}</span></b>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>IFSC Code<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(20, 20, 20);">
                                <b><span>{{ ifsccodedata }}</span></b>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Second Card -->
                <div class="card bg-light bg-gradient">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Actual Paid Amount<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; color: rgb(255, 4, 4);">
                                <input type="text" class="form-control" id="paidamount" name="paidamount" [(ngModel)]="paidAmount" (keypress)="approved_Amount($event)" (blur)="checkAmount()" placeholder="Enter Number" maxlength="10" autocomplete="off">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Paid By<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px;">
                                <select class="form-select" id="bankModeId" [(ngModel)]="selectedPaymentMode" (click)="getMode()">
                                    <option value="">Select</option>
                                    <option *ngFor="let bank of bankMode" [value]="bank.paymentModeId">{{ bank.paymentType }}</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>DD/CHEQUE/ET No.<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px;">
                                <input type="text" class="form-control" id="typeNumber" [(ngModel)]="typeNumber" placeholder="Enter Number" onkeyup="this.value=this.value.replace(/[^a-zA-Z0-9]/g,'');" minlength="6" maxlength="50" (keypress)="getValidNo($event)" oninput="this.value = this.value.toUpperCase()"
                                    autocomplete="off">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Paid Bank Name<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px;">
                                <select class="form-select" id="bankId" [(ngModel)]="selectedBank">
                                    <option value="">Select</option>
                                    <option *ngFor="let bank of bankList" [value]="bank.bankId">{{ bank.bankName }}</option>
                                </select>
                            </div>
                        </div>

                        <!-- <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Date<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px;">
                                <div class="input-group">
                                    <input type="text" class="form-control border-end-0 datepicker" id="currentDate" name="currentDate">
                                    <label class="input-group-text bg-transparent border-start-0" for="currentDate">
                                  <i class="iconbsky-calendar"></i>
                                </label>
                                </div>
                            </div>
                        </div> -->
                        <div class="row">
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px; padding-left: 17px;">
                                <b>Date<span class="text-danger">* </span>:</b>
                            </div>
                            <div class="col-lg-6 col-xxl-6" style="padding-top: 10px;">
                                <div class="input-group">
                                    <input type="text" class="form-control border-end-0 datepicker" id="currentDate" name="currentDate" [(ngModel)]="bankdate" autocomplete="off">
                                    <label class="input-group-text bg-transparent border-start-0" for="currentDate"><i
                                                class="iconbsky-calendar"></i> </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-12 text-center">
                        <button class="btn btn-success mx-2" (click)="submitPayment()">Update</button>
                        <button class="btn btn-danger mx-2" data-bs-dismiss="modal" aria-label="Close" (click)="cancel()">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal justify-content-center" id="appealDisposal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body py-5">
                <span class="text-center text-success">
          {{dtls}}
         </span>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-success" data-bs-dismiss="modal" (click)="modalClose()">Ok</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<!-- Modal -->
<div class="modal fade" id="modalData" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" style="border: 1px solid blue;">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Payment History</h5>
                <div class="col-6" style="text-align:end;">
                    <button class="btn btn-success btn-sm mx-1" style="margin-top: 10px" tooltip="Excel" (click)="downloadList1('excel')">
                        <i class="bi bi-file-earmark-spreadsheet"></i>
                    </button>
                    <button class="btn btn-danger btn-sm mx-1" style="margin-top: 10px" tooltip="pdf" (click)="downloadList1('pdf')">
                        <i class="bi bi-file-earmark-pdf"></i>
                    </button>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-2">
                    <div class="col-lg-2">Float Number:</div>
                    <div class="col-lg-6"><strong>{{float}}</strong></div>
                    <div class="col-lg-2">Generated By:</div>
                    <div class="col-lg-2"><strong>{{createdByName}}</strong></div>
                </div>
                <div class="row mb-2">
                    <div class="col-lg-2">SNA Doctor:</div>
                    <div class="col-lg-4"><strong>{{snoName}}</strong></div>
                    <div class="col-lg-2">Hospital Name:</div>
                    <div class="col-lg-4"><strong>{{hospitalnamedata}}</strong></div>
                </div>
                <div class="row mb-2">
                    <div class="col-lg-2">Hospital Code:</div>
                    <div class="col-lg-4"><strong>{{hospitalCodedata}}</strong></div>
                    <div class="col-lg-2">Freezed Round of Amount:</div>
                    <div class="col-lg-4"><strong>{{totalPaidAmount}}</strong></div>
                </div>
                <div class="table-responsive">
                    <table class="table table-sm table-striped mb-0">
                        <thead>
                            <tr>
                                <th>Sl No</th>
                                <th>Paid Bank Name</th>
                                <th>Payment Type</th>
                                <th>DD/CHEQUE/ET No.</th>
                                <th>Payment Date</th>
                                <th>Actual Paid Amount</th>
                                <th>Bank Name</th>
                                <th>Account Number</th>
                                <th>IFSC Code</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngFor="let float of logdetails; index as i">
                                <tr>
                                    <td>{{ i + 1 }}</td>
                                    <td>{{float.paidbankname}}</td>
                                    <td>{{float.paidby}}</td>
                                    <td>{{float.ddchequeetno}}</td>
                                    <td>{{float.bankdate |date :'dd-MMM-yyyy' }}</td>
                                    <td>{{float.actualpaidamount | indianCurrency}}</td>
                                    <td>{{float.bankname }}</td>
                                    <td>{{float.accountnumber }}</td>
                                    <td>{{float.ifsccode }}</td>
                                </tr>
                            </ng-container>
                            <tr *ngIf="logdetails.length == 0">
                                <td colspan="10" class="text-center text-uppercase">
                                    <strong class="text-danger">No data found !!</strong>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>